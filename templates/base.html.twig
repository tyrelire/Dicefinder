<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>{% block title %}{% endblock %}</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <link rel="icon" type="image/x-icon" href="{{ asset('icons/favicon.ico') }}" />
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        <link href="{{ asset('css/style.css') }}" rel="stylesheet">
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css" rel="stylesheet" />

        {% block stylesheets %}{% endblock %}

        {% block javascripts %}
            {% block importmap %}{{ importmap('app') }}{% endblock %}
        {% endblock %}
    </head>

<style>
    .glassmorphism {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    }

    .glassmorphism-acceptance {
        background: rgba(34, 197, 94, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(34, 197, 94, 0.3);
        box-shadow: 0 4px 30px rgba(0, 128, 0, 0.1);
        transition: transform 0.3s ease-in-out;
    }

    .glassmorphism-acceptance:hover {
        box-shadow: 0 12px 24px rgba(0, 128, 0, 0.3);
    }

    .glassmorphism-player-left {
        background: rgba(220, 38, 38, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(220, 38, 38, 0.3);
        box-shadow: 0 4px 30px rgba(220, 38, 38, 0.1);
        transition: transform 0.3s ease-in-out;
    }

    .glassmorphism-player-left:hover {
        box-shadow: 0 12px 24px rgba(220, 38, 38, 0.3);
    }

    .glassmorphism-invitation-accepted {
        background: rgba(79, 70, 229, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(79, 70, 229, 0.3);
        box-shadow: 0 4px 30px rgba(79, 70, 229, 0.1);
        transition: transform 0.3s ease-in-out;
    }

    .glassmorphism-invitation-accepted:hover {
        box-shadow: 0 12px 24px rgba(79, 70, 229, 0.3);
    }

    .glassmorphism-warning {
        background: rgba(234, 179, 8, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(234, 179, 8, 0.3);
        box-shadow: 0 4px 30px rgba(234, 179, 8, 0.1);
        transition: transform 0.3s ease-in-out;
    }

    .glassmorphism-warning:hover {
        box-shadow: 0 12px 24px rgba(234, 179, 8, 0.3);
    }

    .glassmorphism-purple {
        background: rgba(128, 90, 213, 0.2);
        backdrop-filter: blur(20px);
        border-radius: 20px;
        border: 1px solid rgba(128, 90, 213, 0.5);
        box-shadow: 0 4px 30px rgba(128, 90, 213, 0.3);
        transition: transform 0.3s ease-in-out;
    }

    .glassmorphism-purple:hover {
        box-shadow: 0 12px 24px rgba(128, 90, 213, 0.5);
    }

    .jdr-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 10px;
        border: 2px solid white;
    }

    .button-hover {
        transition: transform 0.3s ease, background-color 0.3s ease;
    }

    .button-hover:hover {
        background-color: rgba(255, 255, 255, 0.2);
    }

    .rounded-full {
        border-radius: 9999px;
    }

    #dropdown-menu {
        width: 24rem;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 16px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
        transition: opacity 0.3s ease, transform 0.3s ease;
        z-index: 50;
    }

    #dropdown-menu:hover {
    }

    #dropdown-menu .notification-item {
        transition: background-color 0.3s ease;
    }

    #dropdown-menu:hover {
    }

    .card-item {
        user-select: none;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 7px 20px 5px rgba(0, 0, 0, 0.4);
        border-radius: 0.7rem;
        overflow: hidden;
        transition: 0.5s all;
        position: relative;
    }

    .card-item::before {
        content: "";
        position: absolute;
        top: -150%;
        left: -150%;
        width: 300%;
        height: 300%;
        background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.1));
        transform: rotate(-45deg);
        transition: 0.5s all ease-in-out;
        opacity: 0;
        pointer-events: none;
        filter: blur(10px);
    }

    .card-item:hover {
        border: 1px solid rgba(255, 255, 255, 0.4);
        box-shadow: 0 10px 60px 15px rgba(0, 0, 0, 0.7);
        transform: scale(1.02);
    }

    .card-item:hover::before {
        top: -150%;
        left: 200%;
        opacity: 1;
        filter: brightness(1.3);
    }
</style>
    <body class="bg-slate-900">
    <div>
        <header class="absolute inset-x-0 top-0 z-50">
            <nav class="flex items-center justify-between p-6 lg:px-8" aria-label="Global">
                    <div class="flex lg:flex-1">
                        <a href="{{ path('app_home') }}" class="-m-1.5 p-1.5">
                            <img class="h-16 w-auto" src="{{ asset('images/logo-dicefinder.png') }}" alt="DiceFinder Logo">
                        </a>
                    </div>
                    <div class="flex lg:hidden">
                        <button id="mobile-menu-toggle" type="button" class="-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-gray-700">
                            <span class="sr-only">Open main menu</span>
                            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
                            </svg>
                        </button>
                    </div>
                    <div class="hidden lg:flex lg:gap-x-12">
                        <a href="{{ path('app_home') }}" class="nav-link text-sm font-semibold leading-6 text-white hover:text-gray-300 {% if app.request.get('_route') == 'app_home' %}active{% endif %}">
                            Accueil
                        </a>
                        <a href="{{ path('app_groupe_j_d_r_index') }}" class="nav-link text-sm font-semibold leading-6 text-white hover:text-gray-300 {% if app.request.get('_route') == 'app_groupe_j_d_r_index' %}active{% endif %}">
                            Les Univers
                        </a>
                        <a href="{{ path('app_my_jdr') }}" class="nav-link text-sm font-semibold leading-6 text-white hover:text-gray-300 {% if app.request.get('_route') == 'app_my_jdr' %}active{% endif %}">
                            Mes Parties
                        </a>
                        <a href="{{ path('app_contact') }}" class="nav-link text-sm font-semibold leading-6 text-white hover:text-gray-300">
                            Nous Contacter
                        </a>
                    </div>
                <div class="hidden lg:flex lg:flex-1 lg:justify-end">
                    <div class="relative flex items-center">
                        <div class="relative w-max mx-auto mr-10">
                            {% if app.user %}
                                <button id="notificationDropdown" type="button" class="relative w-12 h-12 flex items-center justify-center text-white border-none outline-none bg-gray-500 rounded-full transition duration-300 ease-in-out transform hover:scale-110 hover:bg-gray-800 focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 focus:outline-none shadow-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" />
                                    </svg>
                                    <div id="invitation-notification" class="absolute inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-red-500 border-2 border-white rounded-full -top-2 -right-2 {{ (notifications|length + invitations|length) == 0 ? 'hidden' : '' }}">
                                        {{ notifications|length + invitations|length }}
                                    </div>
                                </button>

                                <div id="dropdown-menu" class="hidden absolute right-0 w-96 mt-2 origin-top-right glassmorphism shadow-lg focus:outline-none z-50">
                                    <div class="py-4 px-4">
                                        <h4 class="text-lg font-semibold text-white mb-2">Notifications</h4>
                                        <div id="notifications-list">
                                            {% if notifications|length > 0 %}
                                                {% for notification in notifications|reverse|slice(0, 2) %}
                                                    <div class="notification-item flex items-center px-4 py-4 hover:bg-gray-800 rounded-md cursor-pointer mb-2" onclick="window.location.href='{{ path('app_notifications_index') }}'">
                                                        {% if notification.groupeJDR and notification.groupeJDR.picture %}
                                                            <img class="w-10 h-10 rounded-full object-cover mr-3" src="{{ asset('uploads/images-jdr/' ~ notification.groupeJDR.picture) }}" alt="JDR Picture">
                                                        {% else %}
                                                            <img class="w-10 h-10 rounded-full object-cover mr-3" src="{{ asset('images/default-jdr-avatar.png') }}" alt="Default JDR Picture">
                                                        {% endif %}
                                                        <div>
                                                            <p class="text-sm font-medium text-white">{{ notification.message }}</p>
                                                            <p class="text-xs text-gray-400">{{ notification.createdAt|date('d/m/Y H:i') }}</p>
                                                        </div>
                                                    </div>
                                                {% endfor %}
                                            {% else %}
                                                <p class="px-4 py-2 text-sm text-gray-400">Pas de nouvelles notifications</p>
                                            {% endif %}
                                        </div>
                                        <h4 class="text-lg font-semibold text-white mb-2">Invitations</h4>
                                        <div id="invitations-list">
                                            {% if invitations|length > 0 %}
                                                {% for invitation in invitations|reverse|slice(0, 2) %}
                                                    <div class="notification-item flex items-center px-4 py-4 hover:bg-gray-800 rounded-md cursor-pointer mb-2 invitation-item" 
                                                        data-title="{{ invitation.groupeJDR.title }}" 
                                                        data-inviter="{{ invitation.requestedBy.username }}" 
                                                        data-message="Vous avez été invité à rejoindre l'univers {{ invitation.groupeJDR.title }}."
                                                        data-invitation-id="{{ invitation.id }}">
                                                        <img class="w-10 h-10 rounded-full object-cover mr-3" src="{{ invitation.groupeJDR.picture ? asset('uploads/images-jdr/' ~ invitation.groupeJDR.picture) : asset('images/default-jdr-avatar.png') }}" alt="Avatar Picture"> 
                                                        <div>
                                                            <p class="text-sm font-medium text-white">Invitation pour l'univers "{{ invitation.groupeJDR.title }}"</p>
                                                            <p class="text-xs text-gray-400">Envoyé par {{ invitation.requestedBy.username }}</p>
                                                        </div>
                                                    </div>
                                                {% endfor %}
                                            {% else %}
                                                <p class="px-4 py-2 text-sm text-gray-400">Pas d'invitations en attente</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <a href="{{ path('app_notifications_index') }}" class="block px-4 py-2 text-base text-white hover:bg-gray-700 text-center">Voir toutes les notifications</a>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="relative ml-3">
                    {% if app.user %}
                        <button id="user-menu-toggle" type="button" class="flex items-center justify-center w-12 h-12 rounded-full bg-gray-500 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition duration-300 ease-in-out transform hover:scale-110 hover:bg-gray-700 shadow-lg" aria-expanded="false" aria-haspopup="true">
                            <span class="sr-only">Open user menu</span>
                            {% if app.user.avatar %}
                                <img class="h-10 w-10 rounded-full object-cover" src="{{ asset('uploads/avatars/' ~ app.user.avatar) }}" alt="Profile photo">
                            {% else %}
                                <img class="h-10 w-10 rounded-full object-cover" src="{{ asset('images/default-avatar.png') }}" alt="Default profile photo">
                            {% endif %}
                        </button>
                        <div id="user-menu" class="hidden absolute right-0 z-10 mt-2 w-48 origin-top-right glassmorphism rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none backdrop-filter backdrop-blur-lg bg-opacity-10 bg-white" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-toggle" tabindex="-1">
                            <a href="{{ path('app_profile_show', {'id': app.user.id}) }}" class="block px-4 py-2 text-sm text-white hover:bg-gray-100 hover:rounded-t-lg hover:text-gray-900" role="menuitem" tabindex="-1" id="user-menu-item-0">Votre Profil</a>
                            <a href="{{ path('app_profile_edit') }}" class="block px-4 py-2 text-sm text-white hover:bg-gray-100 hover:text-gray-900" role="menuitem" tabindex="-1" id="user-menu-item-1">Paramètre</a>
                            <a href="{{ path('app_logout') }}" class="block px-4 py-2 text-sm text-white hover:bg-gray-100 hover:rounded-b-lg hover:text-gray-900" role="menuitem" tabindex="-1" id="user-menu-item-2">Déconnexion</a>
                        </div>
                    {% else %}
                        <a href="{{ path('app_login') }}" class="text-sm font-semibold leading-6 text-white">Connexion <span aria-hidden="true">&rarr;</span></a>
                    {% endif %}
                    </div>
                </nav>
            <div class="lg:hidden hidden backdrop-blur-lg bg-slate-900 bg-opacity-80 glassmorphism" id="mobile-menu">
                <div class="space-y-1 pt-2 pb-3">
                    <a href="{{ path('app_home') }}"
                        class="block border-l-4 {{ app.request.get('_route') == 'app_home' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-transparent text-white hover:bg-gray-500' }} py-2 pl-3 pr-4 text-base font-medium">
                        Accueil
                    </a>

                    <a href="{{ path('app_groupe_j_d_r_index') }}"
                        class="block border-l-4 {{ app.request.get('_route') == 'app_groupe_j_d_r_index' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-transparent text-white hover:bg-gray-500' }} py-2 pl-3 pr-4 text-base font-medium">
                        Les Univers
                    </a>

                    <a href="{{ path('app_my_jdr') }}"
                        class="block border-l-4 {{ app.request.get('_route') == 'app_my_jdr' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-transparent text-white hover:bg-gray-500' }} py-2 pl-3 pr-4 text-base font-medium">
                        Mes Parties
                    </a>

                    <a href="{{ path('app_contact') }}"
                        class="block border-l-4 {{ app.request.get('_route') == 'app_contact' ? 'border-indigo-500 bg-indigo-50 text-indigo-700' : 'border-transparent text-white hover:bg-gray-500' }} py-2 pl-3 pr-4 text-base font-medium">
                        Nous Contacter
                    </a>
                    {% if app.user %}
                        <a href="{{ path('app_notifications_index') }}" class="block py-2 pl-3 pr-4 text-base font-medium text-white hover:bg-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6 inline-block mr-2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0"/>
                            </svg>
                            Notifications
                        </a>
                    {% endif %}
                </div>
                <div class="border-t border-gray-200 pt-4 pb-3">
                    <div class="mt-3 space-y-1">
                        {% if app.user %}
                        <a href="{{ path('app_profile_show', {'id': app.user.id}) }}" class="block px-4 py-2 text-base font-medium text-white hover:bg-gray-50">Votre Profil</a>
                        <a href="{{ path('app_profile_edit') }}" class="block px-4 py-2 text-base font-medium text-white hover:bg-gray-50">Paramètre</a>
                        <a href="{{ path('app_logout') }}" class="block px-4 py-2 text-base font-medium text-white hover:bg-gray-50">Déconnexion</a>
                        {% else %}
                        <a href="{{ path('app_login') }}" class="block px-4 py-2 text-base font-medium text-white hover:bg-gray-50">Connexion</a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </header>
    </div>
    <div class="container mx-auto px-4 py-8 mt-10 sm:mt-16">
        {% for message in app.flashes('success') %}
            <div class="alert-message bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-6" role="alert">
                {{ message }}
            </div>
        {% endfor %}
        
        {% for message in app.flashes('error') %}
            <div class="alert-message bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6" role="alert">
                {{ message }}
            </div>
        {% endfor %}

        {% block body %}{% endblock %}
    </div>
    <div id="invitationModal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-center justify-center min-h-screen">
            <div class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity"></div>
            <div class="glassmorphism max-w-lg w-full bg-white backdrop-filter backdrop-blur-lg bg-opacity-10 p-6 rounded-lg shadow-lg transform transition-all relative">
                <div class="absolute top-0 right-0 p-4">
                    <button id="close-modal-btn" class="text-gray-300 hover:text-gray-600 text-2xl">×</button>
                </div>
                <div class="flex items-center">
                    <img id="jdr-avatar-modal" class="w-16 h-16 rounded-full border-2 border-white mr-4" src="#" alt="JDR Avatar">
                    <div>
                        <h3 id="modal-group-title" class="text-xl font-semibold text-white">Titre de l'invitation</h3>
                        <p id="modal-action" class="text-sm text-gray-300">Envoyé par [Nom]</p>
                    </div>
                </div>
                <div class="mt-4">
                    <p id="modal-invitation-message" class="text-base text-gray-300">Vous avez été invité à rejoindre l'univers [Nom de l'univers].</p>
                </div>
                <div class="mt-6 flex justify-center space-x-4">
                    <button id="accept-btn" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-600 transition duration-200">
                        Accepter
                    </button>
                    <button id="later-btn" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition duration-200">
                        Regarder plus tard
                    </button>
                    <button id="refuse-btn" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 transition duration-200">
                        Refuser
                    </button>
                </div>
            </div>
        </div>
    </div>
    <a href="https://discord.gg/7Qu49xxXga" target="_blank" class="fixed bottom-5 right-5 z-50">
        <svg xmlns="http://www.w3.org/2000/svg" width="5rem" height="5rem" viewBox="0 0 256 256" class="w-12 h-12 rounded-full hover:scale-110 transition-transform duration-300">
            <g fill="none">
            <rect width="256" height="256" fill="#5865f2" rx="60"/>
                <g clip-path="url(#skillIconsDiscord0)">
                <path fill="#fff" d="M197.308 64.797a165 165 0 0 0-40.709-12.627a.62.62 0 0 0-.654.31c-1.758 3.126-3.706 7.206-5.069 10.412c-15.373-2.302-30.666-2.302-45.723 0c-1.364-3.278-3.382-7.286-5.148-10.412a.64.64 0 0 0-.655-.31a164.5 164.5 0 0 0-40.709 12.627a.6.6 0 0 0-.268.23c-25.928 38.736-33.03 76.52-29.546 113.836a.7.7 0 0 0 .26.468c17.106 12.563 33.677 20.19 49.94 25.245a.65.65 0 0 0 .702-.23c3.847-5.254 7.276-10.793 10.217-16.618a.633.633 0 0 0-.347-.881c-5.44-2.064-10.619-4.579-15.601-7.436a.642.642 0 0 1-.063-1.064a86 86 0 0 0 3.098-2.428a.62.62 0 0 1 .646-.088c32.732 14.944 68.167 14.944 100.512 0a.62.62 0 0 1 .655.08a80 80 0 0 0 3.106 2.436a.642.642 0 0 1-.055 1.064a102.6 102.6 0 0 1-15.609 7.428a.64.64 0 0 0-.339.889a133 133 0 0 0 10.208 16.61a.64.64 0 0 0 .702.238c16.342-5.055 32.913-12.682 50.02-25.245a.65.65 0 0 0 .26-.46c4.17-43.141-6.985-80.616-29.571-113.836a.5.5 0 0 0-.26-.238M94.834 156.142c-9.855 0-17.975-9.047-17.975-20.158s7.963-20.158 17.975-20.158c10.09 0 18.131 9.127 17.973 20.158c0 11.111-7.962 20.158-17.973 20.158m66.456 0c-9.855 0-17.974-9.047-17.974-20.158s7.962-20.158 17.974-20.158c10.09 0 18.131 9.127 17.974 20.158c0 11.111-7.884 20.158-17.974 20.158"/>
                </g>
            <defs>
                <clipPath id="skillIconsDiscord0">
                <path fill="#fff" d="M28 51h200v154.93H28z"/>
                </clipPath>
            </defs>
            </g>
        </svg>
    </a>
    <footer class="bg-slate-900 mt-12" aria-labelledby="footer-heading">
        <h2 id="footer-heading" class="sr-only">Footer</h2>
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:py-16 lg:px-8">
            <div class="xl:grid xl:grid-cols-3 xl:gap-8">
            <div class="space-y-8 xl:col-span-1">
                <h2 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">DiceFinder</h2>
                <p class="text-gray-500 text-base">DiceFinder est une plateforme dédiée aux amateurs de jeux de rôle. Créez ou rejoignez des parties, connectez-vous avec d'autres joueurs et vivez des aventures épiques. Simple, intuitif et conçu pour tous les passionnés de Univers !</p>
                <div class="flex space-x-6">
                <a href="https://www.reddit.com/r/DiceFinder/" class="text-gray-400 hover:text-gray-500" target="_blank">
                    <span class="sr-only">Reddit</span>
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="5rem" height="5rem" viewBox="0 0 24 24"><path fill="currentColor" d="M10.75 13.04c0-.57-.47-1.04-1.04-1.04s-1.04.47-1.04 1.04a1.04 1.04 0 1 0 2.08 0m3.34 2.37c-.45.45-1.41.61-2.09.61s-1.64-.16-2.09-.61a.26.26 0 0 0-.38 0a.26.26 0 0 0 0 .38c.71.71 2.07.77 2.47.77s1.76-.06 2.47-.77a.26.26 0 0 0 0-.38c-.1-.1-.27-.1-.38 0m.2-3.41c-.57 0-1.04.47-1.04 1.04s.47 1.04 1.04 1.04s1.04-.47 1.04-1.04S14.87 12 14.29 12"/><path fill="currentColor" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10s10-4.48 10-10S17.52 2 12 2m5.8 11.33c.02.14.03.29.03.44c0 2.24-2.61 4.06-5.83 4.06s-5.83-1.82-5.83-4.06c0-.15.01-.3.03-.44c-.51-.23-.86-.74-.86-1.33a1.455 1.455 0 0 1 2.47-1.05c1.01-.73 2.41-1.19 3.96-1.24l.74-3.49c.01-.07.05-.13.11-.16c.06-.04.13-.05.2-.04l2.42.52a1.04 1.04 0 1 1 .93 1.5c-.56 0-1.01-.44-1.04-.99l-2.17-.46l-.66 3.12c1.53.05 2.9.52 3.9 1.24a1.455 1.455 0 1 1 1.6 2.38"/></svg>
                </a>

                <a href="https://www.facebook.com/DiceFinder" class="text-gray-400 hover:text-gray-500" target="_blank">
                    <span class="sr-only">Facebook</span>
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="5rem" height="5rem" viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95"/></svg>
                </a>

                <a href="https://x.com/DiceFinder_" class="text-gray-400 hover:text-gray-500" target="_blank">
                    <span class="sr-only">Twitter</span>
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="5rem" height="5rem" viewBox="0 0 16 16"><path fill="currentColor" d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07l-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"/></svg>
                </a>

                <a href="https://discord.gg/wmq4tzNs4z" class="text-gray-400 hover:text-gray-500" target="_blank">
                    <span class="sr-only">Discord</span>
                    <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" width="5rem" height="5rem" viewBox="0 0 24 24"><path fill="currentColor" d="M19.27 5.33C17.94 4.71 16.5 4.26 15 4a.1.1 0 0 0-.07.03c-.18.33-.39.76-.53 1.09a16.1 16.1 0 0 0-4.8 0c-.14-.34-.35-.76-.54-1.09c-.01-.02-.04-.03-.07-.03c-1.5.26-2.93.71-4.27 1.33c-.01 0-.02.01-.03.02c-2.72 4.07-3.47 8.03-3.1 11.95c0 .02.01.04.03.05c1.8 1.32 3.53 2.12 5.24 2.65c.03.01.06 0 .07-.02c.4-.55.76-1.13 1.07-1.74c.02-.04 0-.08-.04-.09c-.57-.22-1.11-.48-1.64-.78c-.04-.02-.04-.08-.01-.11c.11-.08.22-.17.33-.25c.02-.02.05-.02.07-.01c3.44 1.57 7.15 1.57 10.55 0c.02-.01.05-.01.07.01c.11.09.22.17.33.26c.04.03.04.09-.01.11c-.52.31-1.07.56-1.64.78c-.04.01-.05.06-.04.09c.32.61.68 1.19 1.07 1.74c.03.01.06.02.09.01c1.72-.53 3.45-1.33 5.25-2.65c.02-.01.03-.03.03-.05c.44-4.53-.73-8.46-3.1-11.95c-.01-.01-.02-.02-.04-.02M8.52 14.91c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.84 2.12-1.89 2.12m6.97 0c-1.03 0-1.89-.95-1.89-2.12s.84-2.12 1.89-2.12c1.06 0 1.9.96 1.89 2.12c0 1.17-.83 2.12-1.89 2.12"/></svg>
                </a>
                </div>
            </div>
            <div class="mt-12 grid grid-cols-2 gap-8 xl:mt-0 xl:col-span-2">
                <div class="md:grid md:grid-cols-2 md:gap-8">
                    <div>
                        <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Ressources</h3>
                        <ul role="list" class="mt-4 space-y-4">
                        <li>
                            <a href="{{ path('app_footer_cgv') }}" class="text-base text-gray-500 hover:text-gray-700"> Conditions Générales de Vente </a>
                        </li>

                        <li>
                            <a href="{{ path('app_footer_cgu') }}" class="text-base text-gray-500 hover:text-gray-700"> Conditions Générales d'Utilisation </a>
                        </li>

                        <li>
                            <a href="{{ path('app_footer_policy') }}" class="text-base text-gray-500 hover:text-gray-700"> Politique de Confidentialité </a>
                        </li>
                        </ul>
                    </div>
                    <div class="mt-12 md:mt-0">
                        <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Entreprise</h3>
                        <ul role="list" class="mt-4 space-y-4">
                        <li>
                            <a href="{{ path('app_footer_team') }}" class="text-base text-gray-500 hover:text-gray-700"> Notre équipe </a>
                        </li>
                        <li>
                            <a href="{{ path('app_footer_about') }}" class="text-base text-gray-500 hover:text-gray-700"> À propos de nous </a>
                        </li>
                        <li>
                            <a href="{{ path('app_footer_faq') }}" class="text-base text-gray-500 hover:text-gray-700"> FAQ </a>
                        </li>
                        </ul>
                    </div>
                </div>
                <div class="md:grid md:grid-cols-2 md:gap-8">
                    <div>
                        <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Contact</h3>
                        <ul role="list" class="mt-4 space-y-4">
                        <li>
                            <a href="{{ path('app_contact') }}" class="text-base text-gray-500 hover:text-gray-700"> Nous contacter </a>
                        </li>
                        </ul>
                    </div>
                </div>
            </div>
            </div>
            <div class="mt-12 border-t border-gray-200 pt-8">
                <p class="text-base text-gray-400 xl:text-center">&copy; 2024 All Right Reserved</p>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js"></script>
    <script>
        setTimeout(function() {
            document.querySelectorAll('.alert-message').forEach(function(element) {
                element.style.transition = 'opacity 0.5s';
                element.style.opacity = 0;
                setTimeout(function() {
                    element.remove();
                }, 500);
            });
        }, 5000);

        document.addEventListener('DOMContentLoaded', function () {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const userMenuToggle = document.getElementById('user-menu-toggle');
            const userMenu = document.getElementById('user-menu');
            const notificationDropdown = document.getElementById('notificationDropdown');
            const dropdownMenu = document.getElementById('dropdown-menu');
            const invitationModal = document.getElementById('invitationModal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const laterBtn = document.getElementById('later-btn');
            const acceptBtn = document.getElementById('accept-btn');
            const refuseBtn = document.getElementById('refuse-btn');
            const invitationNotification = document.getElementById('invitation-notification');

            let isDropdownOpen = false;
            let isUserMenuOpen = false;

            if (invitationNotification) {
                const notificationCount = parseInt(invitationNotification.textContent.trim(), 10);
                if (notificationCount === 0) {
                    invitationNotification.classList.add('hidden');
                } else {
                    invitationNotification.classList.remove('hidden');
                }
            }


            function closeUserMenu() {
                if (userMenu && !userMenu.classList.contains('hidden')) {
                    userMenu.classList.add('hidden');
                    isUserMenuOpen = false;
                }
            }

            function closeNotificationMenu() {
                if (dropdownMenu && !dropdownMenu.classList.contains('hidden')) {
                    dropdownMenu.classList.add('hidden');
                    isDropdownOpen = false;
                }
            }

            if (userMenuToggle) {
                userMenuToggle.addEventListener('click', function (e) {
                    e.stopPropagation();
                    closeNotificationMenu();
                    if (userMenu) {
                        isUserMenuOpen = !isUserMenuOpen;
                        userMenu.classList.toggle('hidden', !isUserMenuOpen);
                    }
                });
            }

            if (notificationDropdown) {
                notificationDropdown.addEventListener('click', function (e) {
                    e.stopPropagation();
                    closeUserMenu();
                    if (dropdownMenu) {
                        isDropdownOpen = !isDropdownOpen;
                        dropdownMenu.classList.toggle('hidden', !isDropdownOpen);
                        dropdownMenu.style.opacity = isDropdownOpen ? '1' : '0';
                        dropdownMenu.style.transform = isDropdownOpen ? 'scale(1)' : 'scale(0.95)';
                    }
                });
            }

            document.addEventListener('click', function (event) {
                const isClickInsideNotification = notificationDropdown && notificationDropdown.contains(event.target);
                const isClickInsideDropdown = dropdownMenu && dropdownMenu.contains(event.target);
                const isClickInsideUserMenu = userMenuToggle && userMenuToggle.contains(event.target);
                const isClickInsideUserMenuDropdown = userMenu && userMenu.contains(event.target);

                if (!isClickInsideNotification && !isClickInsideDropdown && isDropdownOpen) {
                    closeNotificationMenu();
                }

                if (!isClickInsideUserMenu && !isClickInsideUserMenuDropdown && isUserMenuOpen) {
                    closeUserMenu();
                }
            });

            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', function () {
                    const menu = document.getElementById('mobile-menu');
                    const expanded = this.getAttribute('aria-expanded') === 'true' || false;
                    this.setAttribute('aria-expanded', !expanded);
                    menu.classList.toggle('hidden');
                });
            }

            const invitationItems = document.querySelectorAll('.invitation-item');
            if (invitationItems && invitationModal && closeModalBtn && laterBtn) {
                invitationItems.forEach(item => {
                    item.addEventListener('click', function () {
                        const title = this.getAttribute('data-title');
                        const inviter = this.getAttribute('data-inviter');
                        const message = this.getAttribute('data-message');
                        const avatarSrc = this.querySelector('img').src;
                        const invitationId = this.getAttribute('data-invitation-id');

                        closeNotificationMenu();
                        closeUserMenu();

                        const modalTitle = document.getElementById('modal-group-title');
                        const modalAction = document.getElementById('modal-action');
                        const modalMessage = document.getElementById('modal-invitation-message');
                        const modalAvatar = document.getElementById('jdr-avatar-modal');

                        modalTitle.textContent = title;
                        modalAction.textContent = "Invitation de " + inviter;
                        modalMessage.textContent = message;
                        modalAvatar.src = avatarSrc;

                        acceptBtn.setAttribute('data-invitation-id', invitationId);
                        refuseBtn.setAttribute('data-invitation-id', invitationId);

                        invitationModal.classList.remove('hidden');
                    });
                });

                closeModalBtn.addEventListener('click', function () {
                    invitationModal.classList.add('hidden');
                });

                laterBtn.addEventListener('click', function () {
                    invitationModal.classList.add('hidden');
                });

                window.addEventListener('click', function (event) {
                    if (event.target === invitationModal) {
                        invitationModal.classList.add('hidden');
                    }
                });

                function handleInvitationResponse(invitationId, response) {
                    fetch(`/api/respond_invitation_base/${invitationId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        body: JSON.stringify({ response: response })
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Erreur lors de la soumission de la réponse');
                        }
                        return response.json();
                    })
                    .then(data => {
                        if (data.success) {
                            location.reload();
                        } else {
                            console.error('Erreur lors de la soumission de la réponse:', data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Erreur:', error);
                    });
                }

                acceptBtn.addEventListener('click', function () {
                    const invitationId = this.getAttribute('data-invitation-id');
                    handleInvitationResponse(invitationId, 'accept');
                });

                refuseBtn.addEventListener('click', function () {
                    const invitationId = this.getAttribute('data-invitation-id');
                    handleInvitationResponse(invitationId, 'refuse');
                });
            }
        });
    </script>
    </body>
</html>
